<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:h="http://java.sun.com/jsf/html"
  template="/WEB-INF/templates/template.xhtml">

  <!-- Top Navigation Bar -->
  <ui:define name="nav-top-content">

    <div class="btn-group pull-right">
      <a class="btn dropdown-toggle" data-toggle="dropdown" href="#"><i
        class="icon-user"></i> <h:outputText value="&#160;" /> <h:outputText
          value="#{identity.currentUser.username} " /><span
        class="caret"></span></a>
      <ul class="dropdown-menu">
        <li><a href="#">Profile</a></li>
        <li class="divider"></li>
        <li><h:form style="margin:0;">
            <h:commandLink action="#{identity.signOut()}">Sign out</h:commandLink>
          </h:form></li>
      </ul>
    </div>
    <div class="btn-group pull-right">
      <a class="btn dropdown-toggle" data-toggle="dropdown" href="#"><i
        class="icon-play"></i> Start Process<span class="caret"></span></a>

      <!-- TODO: create a list of links to start deployed processes -->

      <ul class="dropdown-menu">
        <li><a href="#">Start xy process</a></li>
        <li class="divider"></li>
        <li><a href="#about">start z process</a></li>
      </ul>
    </div>
  </ui:define>
  <!-- /Top Navigation Bar -->

  <!-- Task Navigation -->
  <ui:define name="nav-left-content">
    <h:form style="margin:0;" id="taskNavigation">
      <ul class="nav nav-list">
        <li class="nav-header">Tasks</li>
        <li class="#{taskNavigation.myTasksLink.active ? 'active' : ''}">
          <h:commandLink
            action="#{taskNavigation.select(taskNavigation.myTasksLink)}"
            value="#{taskNavigation.myTasksLink.label}">
            <f:ajax render=":taskList :taskNavigation" />
          </h:commandLink>
        </li>
        <li
          class="#{taskNavigation.unassignedTasksLink.active ? 'active' : ''}"><h:commandLink
            value="#{taskNavigation.unassignedTasksLink.label}"
            action="#{taskNavigation.select(taskNavigation.unassignedTasksLink)}">
            <f:ajax render=":taskList :taskNavigation" />
          </h:commandLink></li>
        <li class="nav-header">Group Tasks</li>
        <ui:repeat value="#{taskNavigation.groupTasksLinks}" var="item">
          <li class="#{item.active ? 'active' : ''}"><h:commandLink
              value="#{item.label}"
              action="#{taskNavigation.select(item)}">
              <f:ajax render=":taskList :taskNavigation" />
            </h:commandLink></li>
        </ui:repeat>
      </ul>
    </h:form>
  </ui:define>
  <!-- /Task Navigation -->

  <!-- Task List -->
  <ui:define name="content">
    <h:panelGroup id="taskList">
      <ui:repeat value="#{taskList.tasks}" var="task">
        <div class="row-fluid">
          <div class="span12">
            <h2>
              <h:outputText value="#{task.name} " />
            </h2>
            <p>
              <h:outputText value="#{task.description} " />
            </p>
            <p>
              <h:outputLink styleClass="btn"
                value="#{taskList.getTaskFormUrl(task)}">Edit &#187;</h:outputLink>
            </p>
          </div>
          <!--/span-->
        </div>
        <!--/row-->
      </ui:repeat>
    </h:panelGroup>
  </ui:define>
  <!-- /Task List -->

</ui:composition>
